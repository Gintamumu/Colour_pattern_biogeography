# Analysis of biogeography of colour patterns in the butterfly Danaus chrysippus
These script accompany the paper "Global biogeography of warning colouration in the butterfly Danaus chrysippus" by Liu et al. (link to be added).

1. Number and spelling mistakes check
2. Full data process 
3. Environmental value add and check
4. Convert full data to 4DB data
5. Trait/phenotype/genotype frequency, allele frequency and sex frequency calculation
6. Trait/phenotype/genotype frequency, sex frequency and number of records distribution maps
7. Number of records maps
8. Allele frequency maps and Transects file made for cline analysis
9. Cline analysis
10. GLS (generalized least-squares) analysis
11. Residual Map of Trait frequency between research and citizen datasets
12. Polymorphism of Trait frequency and location identification


# Requirements
R:
raster,
rgeos,
rgdal,
maptools,
wrld_simpl,
maps,
ggplot2,
mapproj,
geosphere,
Viridis (Colorblind-Friendly Color Maps for R),
PerformanceAnalytics,
AICcmodavg,
ape,
gridExtra,
lme4,
nlme,
raster,
RColorBrewer,
rworldxtra,
rworldmap,
scales,
corrplot,
fmsb,
MuMIn,
ggpubr,
hzar,
doMC,
png

Python:
numpy,
pandas,
matplotlib

Arcmap


# Data

# Acknowledgements
Most of the core codes were contributed by Simon Martin(https://github.com/simonhmartin) and part by Wanzhen Liu.

Some codes for Cline and GLS analysis adapted from HZAR paper https://onlinelibrary.wiley.com/doi/10.1111/1755-0998.12209 and a Falcons paper https://royalsocietypublishing.org/doi/10.1098/rsbl.2021.0116. 
